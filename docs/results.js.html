<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: results.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: results.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/* global google */
import $ from 'jquery'

// Opciones disponibles. Quejas ninguna!
const chartOptions = ['Tarta', 'Barras', 'Columnas', 'Donut']
let type = 'Tarta'

let heroVotes
let comicVotes
let totalHeroVotes

/**
 * Píllame quiénes han sido votados
 */
function getVotedHeroes() {
  const votedHeroes = []
  Object.values(heroVotes.votos).map((vote) => {
    const name = vote.voto
    let found = false
    for (let i = 0; i &lt; votedHeroes.length; i += 1) {
      if (name === votedHeroes[i]) {
        found = true
      }
    }

    if (!found) {
      votedHeroes.push(name)
    }
  })
  return votedHeroes
}

/**
 * Esto hay que refactorizarlo para añadir comics.
 * No me va a dar tiempo.
 */
function drawChart() {
  const data = new google.visualization.DataTable()
  data.addColumn('string', 'Personaje')
  data.addColumn('number', 'Votos')

  let heroName
  let numHeroVotes
  let arialabel = "Total de votos" + totalHeroVotes + ","

  const votedHeroes = getVotedHeroes()
  const numVotedHeroes = votedHeroes.length

  for (let i = 0; i &lt; numVotedHeroes; i += 1) {
    heroName = votedHeroes[i]
    numHeroVotes = 0
    for (let j = 0; j &lt; totalHeroVotes; j += 1) {
      if (heroName === heroVotes.votos[j].voto) {
        numHeroVotes += 1
      }
    }
    arialabel += `${heroName} ${numHeroVotes} votos, `
    data.addRow([heroName, numHeroVotes])
  }

  $('#chartHeroes').attr('aria-label', arialabel)
  const options = {
    title: 'Votaciones de personajes',
    width: 400,
    height: 300,
    backgroundColor: 'transparent',
    legend: { textStyle: { color: 'ghostwhite' } },
    titleTextStyle: { color: 'ghostwhite' },
    hAxis: { textStyle: { color: 'ghostwhite' } },
    vAxis: { textStyle: { color: 'ghostwhite' } }
  }

  let chart
  switch (type) {
    case 'Tarta':
      chart = new google.visualization.PieChart(document.getElementById('chartHeroes'))
      break
    case 'Barras':
      chart = new google.visualization.BarChart(document.getElementById('chartHeroes'))
      break
    case 'Columnas':
      chart = new google.visualization.ColumnChart(document.getElementById('chartHeroes'))
      break
    case 'Donut':
      options.pieHole = 0.4
      chart = new google.visualization.PieChart(document.getElementById('chartHeroes'))
      break
    default:
      break
  }
  
  chart.draw(data, options)
}

/**
 * Simple y sencillo. Llama a drawChart onchange.
 */
function loadSelect() {
  chartOptions.map((option) => {
    $('#selectHeroChart').append(`&lt;option value="${option}">${option}&lt;/option>`)
  })
  $('#selectHeroChart').change(() => {
    type = $('#selectHeroChart').val()
    drawChart()
  })
}

/**
 * La democracia de los frikis!
 */
function loadVotes() {
  if (Storage !== void(0)) {
    heroVotes = JSON.parse(localStorage.herovotes)
    // comicVotes = JSON.parse(localStorage.comicvotes)
    totalHeroVotes = Object.keys(heroVotes.votos).length
    // totalComicVotes = Object.keys(comicVotes.votes).length
  }
}

$(document).ready(() => {
  loadVotes()
  loadSelect()
  setTimeout(() => {
    google.charts.load('visualization', '1', { packages: ['corechart'] })
    google.charts.setOnLoadCallback(drawChart)
  }, 200)
})
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#drawChart">drawChart</a></li><li><a href="global.html#getVotedHeroes">getVotedHeroes</a></li><li><a href="global.html#loadSelect">loadSelect</a></li><li><a href="global.html#loadVotes">loadVotes</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Fri Feb 09 2018 23:13:17 GMT+0000 (Hora estándar GMT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
